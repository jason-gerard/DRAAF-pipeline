% --------------------------------------------------------
% for PDF/A-1b pdf file - +++ DO NOT REMOVE THIS +++
% https://en.wikipedia.org/wiki/PDF/A
\PassOptionsToPackage{hidelinks}{hyperref}
\usepackage[a-1b]{pdfx}   

% --------------------------------------------------------
% set document margins and line spacing
\usepackage[top=45mm,bottom=35mm,inner=35mm,outer=25mm]{geometry}
\usepackage{setspace}
\setstretch{1.6}
% --------------------------------------------------------
% mathematical environment
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{booktabs}
\usepackage{rotating}
\usepackage[nottoc,notlot,notlof]{tocbibind}
\usepackage{pdflscape}
\usepackage{diagbox}
\usepackage{multirow}
\usepackage{colortbl}
\usepackage{booktabs}
\usepackage{hhline}
%\usepackage{tablefootnote}
%\usepackage[nottoc,numbib]{tocbibind}
%\usepackage{natbib}

% --------------------------------------------------------
% figures, graphics, captions and table rows
\usepackage{graphicx}
\usepackage[justification=centering,font={small,singlespacing}]{caption}
\renewcommand{\arraystretch}{1.5}

% --------------------------------------------------------
% references, citations
\usepackage{cite} 

% --------------------------------------------------------
% headers and footers
\usepackage{fancyhdr}
\setlength{\headheight}{14.5pt}
\setlength{\footskip}{16mm} 

\usepackage{etoolbox}%

\usepackage{hyperref}

\newcommand{\makefootnotelist}[1]{%
    \parbox{0.8\textwidth} {%
        \footnotesize{%
            \renewcommand*{\do}[1]{##1\\}%
            \dolistcsloop{#1}}}}%
\renewcommand{\footnote}[1]{%
    \footnotemark{}%
    \def\listname{footlist\thepage}%
    \def\n{$^{\the\numexpr\value{footnote}}$}
    \ifcsdef{\listname}%
        {\listcseadd{\listname}{\n\ #1}}%
        {\csedef{\listname}{}%
        \listcseadd{\listname}{\n\ #1}}%
    \fancypagestyle{fancyfootnote}{%
        \fancyfoot[LO,RE]{\makefootnotelist{\listname}}%
        \fancyfoot[RO,LE]{\thepage}%
        \fancyfoot[C]{}%
    }\thispagestyle{fancyfootnote}}%

\fancypagestyle{default_page}{
\fancyhead[C]{}
\if@twoside%
    \fancyhead[LE,RO]{\sl CHAPTER \thechapter}
    \fancyhead[RE,LO]{}
\else
    \fancyhead[R]{\sl CHAPTER \thechapter}
    \fancyhead[L]{}
\fi
\fancyfoot[L,R]{}
\fancyfoot[C]{\small\thepage}
\renewcommand{\headrulewidth}{0.1mm}
}

\fancypagestyle{empty_page}{
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
}

\fancypagestyle{final_stuff}{
\fancyhead[C]{}
\if@twoside%
    \fancyhead[LE,RO]{\sl \leftmark}
    \fancyhead[RE,LO]{}
\else
    \fancyhead[R]{\sl \leftmark}
    \fancyhead[L]{}
\fi
\fancyfoot[L,R]{}
\fancyfoot[C]{{\small\thepage}}
\renewcommand{\headrulewidth}{0.1mm}
}

% \usepackage{etoolbox}%

% \newcommand{\makefootnotelist}[1]{%
%     \ifcsdef{#1}%
%         {\parbox{0.8\textwidth} {%
%             \footnotesize{%
%             \renewcommand*{\do}[1]{#1\\}%
%             \dolistcsloop{#1}}%
%             %\renewcommand{#1}{}
%             }}%
%         {#1}%
%             }%

% \newcounter{mpFootnoteValueSaver}

% \newcommand{\fancyfootnote}[1]{%
%     \stepcounter{mpFootnoteValueSaver}%
%     \footnotemark[\value{mpFootnoteValueSaver}]{}%
%     \def\listname{footlist}%
%     \def\n{$^{\the\numexpr\value{mpFootnoteValueSaver}}$}
%     \ifcsdef{\listname}%
%         {}%
%         {\csedef{\listname}{}}%
%     \listcseadd{\listname}{\n\ #1}}
    
% \renewcommand{\footnote}[1]{%
%     \fancyfootnote{#1}}

\makeatletter
\def\emptypage@emptypage{%
    \thispagestyle{empty}
    % \hbox{}%
    \vspace*{\fill}
    \begin{center}
    {\footnotesize This page intentionally left blank.}
    \end{center}
    \vspace{\fill}
    \newpage%    
}%
\def\cleardoublepage{%
        \clearpage%
        \if@twoside%
            \ifodd\c@page%
                % do nothing
            \else%
                \emptypage@emptypage%
                
            \fi%
        \fi%
    }%
\makeatother


% --------------------------------------------------------
% handle links and urls
\usepackage{url}

% --------------------------------------------------------
% code listing
\usepackage{listings}

